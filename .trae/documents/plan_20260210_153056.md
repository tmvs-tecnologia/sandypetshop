I will fix the `ReferenceError: extrasTotal is not defined` and adjust the WhatsApp link position in `src/components/AppointmentCard.tsx`.

1.  **Fix `extrasTotal` Reference Error**:
    *   In the previous refactor, I accidentally deleted the calculation block for `extrasTotal` but kept the usage `const displayPrice: number = Math.max(0, Number(price || 0) - monthlyDiscount) + extrasTotal;`.
    *   I will restore the `extrasTotal` calculation logic before `displayPrice` is defined.

2.  **Reposition WhatsApp Link**:
    *   Move the WhatsApp link code block to be immediately after the "Tutor" div in the grid.
    *   Since the grid is `grid-cols-2`, "Date & Time" is at index 0, "Tutor" is at index 1.
    *   The WhatsApp link should be "below the tutor `div` and aligned next to `div`". This implies it should be in the second column, right under the Tutor.
    *   I will place it in the grid structure so it naturally flows into the correct column or force it if necessary. If "Tutor" is the second item (right column), the next item naturally goes to the left column unless I control the order.
    *   However, the user said "aligned next to `div`" (presumably the left column div).
    *   Let's look at the current grid:
        1. Date & Time (Left)
        2. Tutor (Right)
        3. Service (Full width `col-span-2`)
        4. Condominium (Full width `col-span-2`)
        5. Responsible (Full width `col-span-2`)
        6. WhatsApp (Full width `col-span-2` at bottom)
    *   The user wants: "`a` deve ficar abaixo do tutor `div` e deve ter o titulo Whatsapp, alinhado ao lado de `div`".
    *   If I place it after Tutor, it would be the 3rd item. In a 2-col grid, that puts it on the Left (below Date & Time). "aligned next to `div`" might mean "next to the Date/Time div" (which is on the left) OR "next to the Tutor div" (which is on the right).
    *   Wait, "aligned next to `div`" is ambiguous.
    *   "below the tutor `div`": Tutor is top-right. Below it is the next row, right side.
    *   "aligned next to `div`": If I put it in the slot below Tutor (row 2, col 2), it is next to whatever is in row 2, col 1.
    *   Let's try to put it in the same visual row as "Date & Time" but below "Tutor"? No, that's impossible in a standard flow.
    *   Maybe the user wants it to *replace* the Tutor's position? No, "below".
    *   Let's assume they want a dedicated slot for it.
    *   I will structure the grid as:
        *   Row 1 Left: Date & Time
        *   Row 1 Right: Tutor
        *   Row 2 Left: (Empty? Or something else?)
        *   Row 2 Right: WhatsApp
    *   Or maybe:
        *   Row 1 Left: Date & Time
        *   Row 1 Right: Tutor
        *   Row 2 Left: Service
        *   Row 2 Right: WhatsApp?
    *   Let's try to fit it nicely.
    *   I will add a specific grid item for WhatsApp with a "WhatsApp" label (like the others have "Tutor", "Data & Hora") and place it after the Tutor div.
    *   I'll change the `col-span-2` of the WhatsApp link to be a standard single column item if it fits, or keep it `col-span-2` if it's meant to be full width but just moved up.
    *   Given the instruction "below the tutor `div`", I will place it immediately after the Tutor div in the JSX.
    *   And "aligned next to `div`" -> next to the element that is on its left.
    *   So:
        1. Date & Time
        2. Tutor
        3. Service (currently col-span-2) -> Make this col-span-2?
        4. WhatsApp?
    *   Actually, if I make Service col-span-2, it forces a new row.
    *   To make WhatsApp sit below Tutor (Right column), I need something in the Left column of that row, OR I need to reorganize.
    *   Maybe "Date & Time" and "Tutor" are row 1.
    *   Row 2 could be "Service" (Left) and "WhatsApp" (Right)?
    *   Let's try that. It makes sense. Service is important, WhatsApp is important.
    *   Condominium can be full width or share with Responsible.

    *   Refined Plan for Layout:
        1. Date & Time
        2. Tutor
        3. WhatsApp (Right side, below Tutor? No, grid auto-placement goes Left then Right).
        4. If I want it Right, I need a Left item.
        5. Let's make "Service" taking the Left slot of Row 2?
        6. So:
           - Date & Time
           - Tutor
           - Service (Left)
           - WhatsApp (Right)
           - Condominium (col-span-2)
           - Responsible (col-span-2)

    *   Wait, the user said "aligned next to `div`".
    *   If I put WhatsApp at index 3 (Row 2, Right), it is aligned next to index 2 (Row 2, Left).
    *   So I need to move Service to index 2 (remove col-span-2) and WhatsApp to index 3.
    *   Also add the label "WhatsApp" to the WhatsApp link to match the style of other fields.

3.  **Fix Logic**:
    *   Re-introduce `extrasTotal` calculation.

I will verify the changes by reading the file again.
